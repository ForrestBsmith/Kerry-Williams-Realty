<!doctype html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agent Profile | 44 Realty Group</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="style.css">
  <script src="layout.js" defer></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js" defer></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js" defer></script>
  <script src="user.js" defer></script>
  <script src="agent.js" defer></script>
</head>
<body>
  <header class="site-nav shadow-sm"></header>

  <main class="bg-light">
    <section id="agent-hero" class="py-5">
      <div class="container">
        <div class="placeholder-card p-4 border rounded-3 bg-white text-center text-muted">Loading agent...</div>
      </div>
    </section>

    <section id="agent-metrics" class="pb-4 d-none">
      <div class="container">
        <div class="row g-3" id="agent-metrics-cards"></div>
      </div>
    </section>

    <section id="agent-performance" class="pb-5 d-none">
      <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
          <div>
            <p class="text-uppercase small text-accent mb-1">Performance</p>
            <h3 class="fw-bold mb-0">Sales & listing trends</h3>
          </div>
          <button class="btn btn-outline-secondary btn-sm" id="agent-message-btn">
            <i class="bi bi-chat-dots me-2"></i>Message this agent
          </button>
        </div>
        <div class="row g-3">
          <div class="col-md-6">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <h5 class="mb-0">Monthly sold volume</h5>
                  <span class="badge bg-light text-dark" id="sold-count-pill"></span>
                </div>
                <canvas id="sold-chart" height="180"></canvas>
                <p class="small text-muted mb-0 mt-2" id="sold-chart-empty"></p>
              </div>
            </div>
          </div>
          <div class="col-md-6">
            <div class="card shadow-sm border-0 h-100">
              <div class="card-body">
                <div class="d-flex justify-content-between align-items-center mb-3">
                  <h5 class="mb-0">Active listing prices</h5>
                  <span class="badge bg-light text-dark" id="active-count-pill"></span>
                </div>
                <canvas id="active-chart" height="180"></canvas>
                <p class="small text-muted mb-0 mt-2" id="active-chart-empty"></p>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="pb-5">
      <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
          <div>
            <p class="text-uppercase small text-accent mb-1">Active listings</p>
            <h3 class="fw-bold mb-0">Homes represented</h3>
          </div>
          <a href="Buying.html" class="btn btn-outline-secondary btn-sm">View all homes</a>
        </div>
        <div class="row g-3" id="agent-listings">
          <div class="col-12">
            <div class="placeholder-card p-4 border rounded-3 bg-white text-center text-muted">Fetching listings...</div>
          </div>
        </div>
      </div>
    </section>

    <section class="pb-5">
      <div class="container">
        <div class="card border-0 shadow-sm">
          <div class="card-body">
            <div class="d-flex justify-content-between align-items-center mb-3 flex-wrap gap-2">
              <div>
                <p class="text-uppercase small text-accent mb-1">On the map</p>
                <h4 class="fw-bold mb-0">Where this agent is working</h4>
              </div>
              <span class="badge bg-light text-dark" id="map-count-pill">0 listings mapped</span>
            </div>
            <div id="agent-map" style="height: 420px;" class="rounded-4 overflow-hidden"></div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <footer class="py-4 bg-white site-footer"></footer>

  <!-- Photos Modal -->
  <div class="modal fade" id="photosModal" tabindex="-1" aria-labelledby="photosModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="photosModalLabel">Home Address</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="photosModalBody"></div>
      </div>
    </div>
  </div>

  <!-- Schedule Modal -->
  <div class="modal fade" id="scheduleModal" tabindex="-1" aria-labelledby="scheduleModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="scheduleModalLabel">Schedule a Viewing</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="scheduleModalBody"></div>
      </div>
    </div>
  </div>

  <!-- Details Modal -->
  <div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-scrollable">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="detailsModalLabel">Property Details</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body" id="detailsModalBody"></div>
      </div>
    </div>
  </div>

  <!-- Message Modal -->
  <div class="modal fade" id="messageModal" tabindex="-1" aria-labelledby="messageModalLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="messageModalLabel">Message this agent</h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <form id="agent-message-form" class="d-grid gap-3">
            <div>
              <label class="form-label">Name</label>
              <input type="text" class="form-control" name="name" required>
            </div>
            <div>
              <label class="form-label">Email</label>
              <input type="email" class="form-control" name="email" required>
            </div>
            <div>
              <label class="form-label">Message</label>
              <textarea class="form-control" name="message" rows="3" required placeholder="Tell us how we can help"></textarea>
            </div>
            <input type="hidden" name="agentName">
            <input type="hidden" name="agentId">
            <div id="message-status" class="small text-muted d-none"></div>
            <button type="submit" class="btn btn-dark w-100">Send message</button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
</body>
</html>
