<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Agent Profile - Kelly Williams Realty</title>
    <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
</head>
<body>
    <!-- NAVBAR START -->
    <header>
      <nav class="navbar navbar-expand-sm">
        <div class="container-fluid">
          <a class="navbar-brand" href="index.html"><h2>Kelly Williams Realty</h2></a>
          <button class="navbar-toggler bg-transparent" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse">
            <span class="navbar-toggler-icon"></span>
          </button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav text-center">
              <li class="nav-item"><a class="nav-link" href="Agents.html">AGENTS</a></li>
              <li class="nav-item"><a class="nav-link" href="Buying.html">BUYING</a></li>
              <li class="nav-item"><a class="nav-link" href="Selling.html">SELLING</a></li>
              <li class="nav-item"><a class="nav-link" href="FAQ.html">FAQs</a></li>
            </ul>
          </div>
        </div>
      </nav>
    </header>
    <!-- NAVBAR END -->

  <main class="container mt-4">
    <h1 id="agent-name" class="text-center mb-4"></h1>
    <div id="agent-bio" class=""></div>    <!-- Features get inserted here -->
<div class="col-md-12 mt-4 mb-5">
  <h3>Available Listings</h3>
  <div id="property-map" style="height: 400px;"></div>
</div>
    </div>
  </div>
    <div id="property-list" class="row"></div>
    


<!-- Photos Modal -->
<div class="modal fade" id="photosModal" tabindex="-1" aria-labelledby="photosModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="photosModalLabel">Home Address</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="photosModalBody">
        <!-- Carousel will be injected here -->
      </div>
    </div>
  </div>
</div>

<!-- Schedule Modal -->
<div class="modal fade" id="scheduleModal" tabindex="-1" aria-labelledby="scheduleModalLabel" aria-hidden="true">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="scheduleModalLabel">Schedule a Viewing</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="scheduleModalBody">
        <!-- Form will be injected here -->
      </div>
    </div>
  </div>
</div>

<!-- Details Modal -->
<div class="modal fade" id="detailsModal" tabindex="-1" aria-labelledby="detailsModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="detailsModalLabel">Property Details</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body" id="detailsModalBody">
        <!-- Details will be injected here -->
      </div>
    </div>
  </div>


<div id="agent-details"></div>

<!-- Floating Contact Button -->
<div id="floating-contact">
  <button id="contact-btn">ðŸ“ž Contact Agent</button>
</div>

<!-- Contact Panel -->
<div id="contact-panel">
  <span id="close-panel">Ã—</span>
  <h4 id="agent-name"></h4>
  <p id="agent-phone"></p>
  <p id="agent-email"></p>
</div>

<style>
  /* Force floating contact button to be visible on all devices */
#floating-contact-btn {
  display: block !important; 
  background: linear-gradient(135deg,  rgba(106, 142, 35, 0.754), #075308) !important;
  color: #fff !important;
  box-shadow: 0 4px 10px rgba(0,0,0,0.2) !important;
  position: fixed !important; 
  cursor: pointer !important;
  font-size: 16px !important; 
  border-radius: 25px !important;
  bottom: calc(20px + env(safe-area-inset-bottom)) !important;
  right: 20px !important;
  z-index: 999999 !important;
  padding: 12px 18px !important; /* restore if overwritten */
  border: none !important;
}


#floating-contact-btn:hover {
  background: linear-gradient(135deg, #feb47b, #ff7e5f) !important;
}

/* Overlay */
#contact-popup-overlay {
  position: fixed;
  top: 0; left: 0;
  width: 100%; height: 100%;
  background: rgba(0,0,0,0.5);
  display: none;
  justify-content: center;
  align-items: center;
  z-index: 1000000;
}

/* Popup box */
#contact-popup {
  background: #fff;
  padding: 20px;
  border-radius: 12px;
  max-width: 520px;
  width: 100%;
  box-shadow: 0 4px 15px rgba(0,0,0,0.3);
}

#contact-popup h2 {
  margin-top: 0;
  font-size: 1rem;
  text-align: center;
}

/* Contact rows */
.contact-row {
  display: flex;
  justify-content: space-between;
  align-items: center;
  background: #f8f8f8;
  padding: 8px 10px;
  margin: 8px 0;
  border-radius: 8px;
  font-size: 0.85rem !important;
}

.contact-row span {
  word-break: break-word;
}

.copy-btn {
  background: none;
  border: none;
  cursor: pointer;
  color: #5d666f;
  font-size: .75rem !important;
  display: flex;
  align-items: center;
}

.copy-btn:hover {
  text-decoration: underline;
}

#close-popup {
  margin-top: 15px;
  display: block;
  width: 100%;
  background: #56595c;
  color: white;
  padding: 10px;
  border: none;
  border-radius: 8px;
  font-size: 1rem;
  cursor: pointer;
}

#close-popup:hover {
  background: #0056b3;
}
</style>



<script>
document.addEventListener("DOMContentLoaded", () => {
  // Get agent ID from URL parameter, e.g. ?agent=mark-smith
  const urlParams = new URLSearchParams(window.location.search);
  const agentId = urlParams.get("agent")?.toLowerCase();

  // Create floating button
  const contactBtn = document.createElement("button");
  contactBtn.id = "floating-contact-btn";
  contactBtn.innerHTML = "ðŸ“ž Contact Agent";
  document.body.appendChild(contactBtn);

  // Create popup overlay but empty for now
  const overlay = document.createElement("div");
  overlay.id = "contact-popup-overlay";
  overlay.style.display = "none"; // hidden initially
  document.body.appendChild(overlay);

  // Fetch JSON and get agents array
  fetch("properties-1.json")
    .then(res => {
      if (!res.ok) throw new Error("Failed to load JSON");
      return res.json();
    })
    .then(data => {
      const agents = data[0].agents; // Your JSON is an array with one object containing agents
      const agent = agents.find(a => a.id.toLowerCase() === agentId);

      if (!agent) {
        contactBtn.disabled = true;
        contactBtn.textContent = "Agent not found";
        return;
      }

      // On click, fill popup content dynamically and show it
      contactBtn.addEventListener("click", () => {
        overlay.innerHTML = `
          <div id="contact-popup" style="background:#fff; padding:20px; max-width:300px; margin:auto; border-radius:8px; box-shadow:0 0 10px rgba(0,0,0,0.25);">
            <h2>${agent.name}</h2>
            <div class="contact-row" style="margin-bottom:10px;">
              <strong>Email:</strong> <span>${agent.email}</span>
              <button class="copy-btn" data-copy="${agent.email}" style="margin-left:10px;">ðŸ“‹ Copy</button>
            </div>
            <div class="contact-row" style="margin-bottom:10px;">
              <strong>Phone:</strong> <span>${agent.phone}</span>
              <button class="copy-btn" data-copy="${agent.phone}" style="margin-left:10px;">ðŸ“‹ Copy</button>
            </div>
            <button id="close-popup" style="margin-top:15px;">Close</button>
          </div>
        `;
        overlay.style.display = "flex";
        overlay.style.position = "fixed";
        overlay.style.top = "0";
        overlay.style.left = "0";
        overlay.style.width = "100%";
        overlay.style.height = "100%";
        overlay.style.justifyContent = "center";
        overlay.style.alignItems = "center";
        overlay.style.backgroundColor = "rgba(0,0,0,0.5)";
      });

      // Close popup when clicking outside or Close button
      overlay.addEventListener("click", (e) => {
        if (e.target.id === "contact-popup-overlay" || e.target.id === "close-popup") {
          overlay.style.display = "none";
        }
      });

      // Copy to clipboard
      overlay.addEventListener("click", (e) => {
        if (e.target.classList.contains("copy-btn")) {
          const textToCopy = e.target.getAttribute("data-copy");
          navigator.clipboard.writeText(textToCopy).then(() => {
            e.target.textContent = "âœ… Copied!";
            setTimeout(() => {
              e.target.textContent = "ðŸ“‹ Copy";
            }, 1500);
          });
        }
      });
    })
    .catch(err => {
      console.error(err);
      contactBtn.disabled = true;
      contactBtn.textContent = "Failed to load agent info";
    });
});
</script>


  </main>


      <!-- FOOTER -->
      <footer class="text-muted py-5">
        <div class="container">
          <hr>
          <div class="row">
            <div class="col-6 col-md-3 mb-3">
              <h5>Services</h5>
              <ul class="list-unstyled">
                <li><a href="FAQ.html">Financing</a></li>
                <li><a href="FAQ.html">Contact Us</a></li>
                <li><a href="FAQ.html">Loans</a></li>
                <li><a href="FAQ.html">FAQs</a></li>
                <li><a href="FAQ.html">About</a></li>
              </ul>
            </div>
            <div class="col-6 col-md-3 mb-3">
              <h5>Properties</h5>
              <ul class="list-unstyled">
                <li><a href="Buying.html">Home</a></li>
                <li><a href="Buying.html">Apartment</a></li>
                <li><a href="Buying.html">Condo</a></li>
                <li><a href="Buying.html">Rental</a></li>
                <li><a href="Buying.html">Commercial</a></li>
              </ul>
            </div>
            <div class="col-md-6 text-center">
              <h5 class="text-center">Subscribe to Our Newsletter</h5>
              <p class="mb-4">Monthly digest of what's new and exciting from us.</p>
              <form class="d-flex flex-column flex-sm-row gap-2">
                <input type="email" class="form-control text-center" placeholder="Email address">
                <button class="btn" type="submit">Subscribe</button>
              </form>
            </div>
          </div>

          <div class="d-flex flex-column flex-sm-row justify-content-between py-4 mt-4 border-top">
            <p>&copy; 2024 Kelly Williams Realty. All rights reserved.</p>
            <ul class="list-unstyled d-flex">
              <li class="ms-3"><a href="#"><i class="bi bi-twitter"></i></a></li>
              <li class="ms-3"><a href="#"><i class="bi bi-instagram"></i></a></li>
              <li class="ms-3"><a href="#"><i class="bi bi-facebook"></i></a></li>
            </ul>
          </div>
        </div>
      </footer>



  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
  <script src="agent.js"></script>
</body>
</html>